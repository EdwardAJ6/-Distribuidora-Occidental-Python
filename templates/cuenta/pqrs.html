{% extends 'base.html' %}

{% load static %}

{% block content %}
{% url 'direcciones:direcciones' as direcciones %}

<section class="section-pagetop bg-gray">
	<div class="container">
		<h2 class="title-page">Mis PQRS </h2>
	</div>
	</section>
	
	<section class="section-content padding-y">
	<div class="container">
	
	<div class="row">
		<aside class="col-md-3">
			{% include 'incluidos/dash.html' %}

		</aside>
		<main class="col-md-9">
	
			<h4>Bienvenido</h4>
			<p>Â¿Que peticion, queja o reclamo tienes? Cuentanos ðŸ‘‡</p>

			<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
	Genera tu PQR
  </button>
  
  <!-- Modal Boostrap 4.3 -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog" role="document">
	  <div class="modal-content">
		<div class="modal-header" id="saludo" style="font-size: 1.5em; font-weight: bold;">
		  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			<span aria-hidden="true">&times;</span>
		  </button>
		</div>
		<div class="modal-body">
			<form action="{% url 'subir_pqr' %}" method="POST">
				{% csrf_token %}
				<div class="modal-body">
				  <h5 class="text-center">CuÃ©ntanos, Â¿quÃ© sucede?</h5>

				  <div class="form-row">
					<div class="col form-group">
					  <label for="">Tipo de PQR</label>
					  <select name="tipo" class="form-control" required>
						<option value="">Seleccione un tipo</option>
						<option value="Peticion">PeticiÃ³n</option>
						<option value="Queja">Queja</option>
						<option value="Reclamo">Reclamo</option>
						<option value="Sugerencia">Sugerencia</option>
					  </select>
					</div>
				  </div>

				  <div class="form-row">
					<div class="col form-group">
					  <label for="">TÃ­tulo o Asunto de la PQR</label>
					  <input type="text" name="titulo" class="form-control" required />
					</div>
				  </div>
	  
				  <div class="form-row">
					<div class="col form-group">
					  <label for="">DescripciÃ³n</label>
					  <textarea
						name="descripcion"
						rows="2"
						class="form-control"
					  ></textarea>
					</div>
				  </div>
				</div>
				<div class="modal-footer">
				  <button type="submit" class="btn btn-primary">
					Guardar cambios
				  </button>
				  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
				</div>
			  </form>
		</div>
		<div class="modal-footer">
			<p> Â¡Gracias por comentarnos tu PQRS, esto es de gran ayuda, asi podemos mejorar nuestros servicios!</p>
		</div>
	  </div>
	</div>
  </div>

	
			<table class="table">
				<thead>
				  <tr>
					<th scope="col">NÃºmero de PQR</th>
					<th scope="col">TÃ­tulo</th>
					<th scope="col">DescripciÃ³n</th>
					<th scope="col">Tipo</th>
					<th scope="col">Fecha de CreaciÃ³n</th>
					<th scope="col">Respuesta PQR</th>
					<th scope="col">Fecha de Respuesta</th>
				  </tr>
				</thead>
				<tbody>
					{% for pqr in pqrs %}
				  <tr>
					<th scope="row">{{pqr.id}}</th>
					<td>{{pqr.titulo}}</td>
					<td>{{pqr.descripcion}}</td>
					<td>{{pqr.tipo}}</td>
					<td>{{pqr.creada_en}}</td>
					{% if pqr.respuesta %}
					<td>{{pqr.respuesta}}</td>
					<td>{{pqr.fecha_respuesta}}</td>
					{% else %}
					<td>Su PQR no ha sido respondida.</td>
					<td>La respuesta a su PQR tiene un plazo mÃ¡ximo de 3 dÃ­as. Es decir, su PQR serÃ¡ respondida el dÃ­a {{estimated_response_date|date:"d-m-Y"}}</td>
					{% endif %}
				  </tr>
				  {% endfor %}
				</tbody>
			  </table>
			  
		
		</main>
	</div>
	</div>
</section>

<!--Mensaje de zona horaria -->

<script>
    var saludo = document.getElementById("saludo");
    var hora = new Date().getHours();

    if (hora >= 0 && hora < 12) {
        saludo.innerHTML = "Hola, buenos dÃ­as";
    } else if (hora >= 12 && hora < 18) {
        saludo.innerHTML = "Hola, buenas tardes";
    } else {
        saludo.innerHTML = "Hola, buenas noches";
    }
</script>

{% endblock %}